

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Make a fit over an entire region of the field &mdash; Orcs latest documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/logo.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="How precise must be the input velocity parameter ?" href="script_example_velocity_parameter_precision.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Orcs
          

          
            
            <img src="_static/logo_sidebar.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                lastest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="introduction.html">Introduction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html#a-few-words-on-orcs">A few words on ORCS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="introduction.html#the-fitting-engine">The fitting engine</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html#models">Models</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="introduction.html#models-parameters">Models parameters</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="script_example_velocity_parameter_precision.html">How precise must be the input velocity parameter ?</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Make a fit over an entire region of the field</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#uncertainties">Uncertainties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#list-of-available-lines">List of available lines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core_module.html">Core module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_module.html">Fit module</a></li>
<li class="toctree-l1"><a class="reference internal" href="process_module.html">Process module</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils_module.html">Utils module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Orcs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="introduction.html">Introduction</a> &raquo;</li>
        
      <li>Make a fit over an entire region of the field</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/script_example_fit_region.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Make-a-fit-over-an-entire-region-of-the-field">
<h1>Make a fit over an entire region of the field<a class="headerlink" href="#Make-a-fit-over-an-entire-region-of-the-field" title="Permalink to this headline">¶</a></h1>
<p>This is a complete example of a fit over an entire region of interest (ROI). The different steps covered are :</p>
<ol class="arabic simple">
<li><p>Extraction of a deep frame and the WCS</p></li>
<li><p>Definition of the ROI with DS9</p></li>
<li><p>Fit of a single spectrum in order to get an initial guess on the velocity of the gas</p></li>
<li><p>Fit of the entire ROI</p></li>
<li><p>Visualization of the resulting maps</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import orcs.process
import pylab as pl
import orb.utils.io
import numpy as np
from importlib import reload
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cube = orcs.process.SpectralCube(&#39;/home/thomas/local/M57_SN3.merged.cm1.1.0.hdf5&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:root:both level2 and level3 in attrs
INFO:root:Cube is level 3
INFO:root:shape: (2048, 2064, 593)
INFO:root:wavenumber calibration: True
INFO:root:flux calibration: True
INFO:root:wcs calibration: True
</pre></div></div>
</div>
<div class="section" id="Export-the-deep-frame-with-its-WCS-to-define-the-ROI">
<h2>Export the deep frame with its WCS to define the ROI<a class="headerlink" href="#Export-the-deep-frame-with-its-WCS-to-define-the-ROI" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>deep_frame = cube.get_deep_frame()
deep_frame.imshow(cmap=&#39;gray_r&#39;, perc=99.9)
pl.xlim((550,970))
pl.ylim((650,1030))
deep_frame.to_fits(&#39;deep_frame.fits&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:root:Complex data cast to float32 (FITS format do not support complex data)
INFO:root:Data written as deep_frame.fits in 0.29 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_4_1.png" src="_images/script_example_fit_region_4_1.png" />
</div>
</div>
</div>
<div class="section" id="Use-ds9-to-define-the-ROI">
<h2>Use ds9 to define the ROI<a class="headerlink" href="#Use-ds9-to-define-the-ROI" title="Permalink to this headline">¶</a></h2>
<p>from here you can use ds9 to define the region of interest on the deep frame. You can export the region in celestial or image coordinates. Note that the region can also be passed as a collection of pixel position as it is returned by a function such as numpy.nonzero(). the content of the generated ds9 region file is:</p>
# Region file format: DS9 version 4.1
global color=green dashlist=8 3 width=1 font="helvetica 10 normal roman" select=1 highlite=1 dash=0 fixed=0 edit=1 move=1 delete=1 include=1 source=1
fk5
circle(18:53:35.739,+33:02:03.821,12.264")<p>It can be plotted (for checking purpose) with pyregion (<a class="reference external" href="http://pyregion.readthedocs.io/en/latest/index.html">http://pyregion.readthedocs.io/en/latest/index.html</a>) like this</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import pyregion

# draw the background image
deep_frame.imshow(cmap=&#39;gray_r&#39;, perc=99.9)
pl.xlim((550,970))
pl.ylim((650,1030))

# load region file and draw the regions
reg = pyregion.open(&#39;region.reg&#39;).as_imagecoord(cube.get_wcs_header())

ax = pl.gca()
patch_list, artist_list = reg.get_mpl_patches_texts()
for p in patch_list:
    ax.add_patch(p)
for t in artist_list:
    ax.add_artist(t)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_8_0.png" src="_images/script_example_fit_region_8_0.png" />
</div>
</div>
</div>
<div class="section" id="Extract-a-spectrum-of-the-region-to-estimate-the-fit-parameters">
<h2>Extract a spectrum of the region to estimate the fit parameters<a class="headerlink" href="#Extract-a-spectrum-of-the-region-to-estimate-the-fit-parameters" title="Permalink to this headline">¶</a></h2>
<p>parameters estimation can be done automatically. Only one velocity component is considered along the line of sight.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>spectrum = cube.get_spectrum(749, 898, 3)

# all the spectrum
spectrum.plot()
pl.xlim((14750,15500))
pl.grid()

vel, fluxes = spectrum.estimate_parameters((&#39;[NII]6548&#39;, &#39;Halpha&#39;, &#39;[NII]6583&#39;, &#39;[SII]6716&#39;, &#39;[SII]6731&#39;), [-300, 300])
print(&#39;velocity estimate (km/s)&#39;, vel)
print(&#39;fluxes estimate (erg/cm^2/s)&#39;, fluxes)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
velocity estimate (km/s) 60.0
fluxes estimate (erg/cm^2/s) [6.702803507687017e-14, 2.303640071085414e-13, 2.159394315301985e-13, 1.2902492268605936e-14, 1.0764452284205345e-14]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_10_1.png" src="_images/script_example_fit_region_10_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># set up the fit to check if before running the long extraction process over the whole ROI

fit = spectrum.fit((&#39;[NII]6548&#39;, &#39;Halpha&#39;, &#39;[NII]6583&#39;, &#39;[SII]6716&#39;, &#39;[SII]6731&#39;),
                   fmodel=&#39;sincgauss&#39;,
                   pos_def=[&#39;1&#39;,&#39;2&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;],
                   pos_cov=[vel, vel],
                   sigma_def=[&#39;1&#39;,&#39;2&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;],
                   sigma_cov=[20, 20],
                   nofilter=True)

print(fit)
new_vel = fit[&#39;velocity&#39;][0], fit[&#39;velocity&#39;][1]

pl.figure(figsize=(20,10))
spectrum.plot(label=&#39;spectrum&#39;)
fit.get_spectrum().plot(label=&#39;fitted model&#39;)
pl.xlim((14800,15300))
pl.legend()
pl.grid()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/thomas/miniconda3/envs/orb3/lib/python3.7/site-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_cell` automatically in the future. Please pass the result to `transformed_cell` argument and any exception that happen during thetransform in `preprocessing_exc_tuple` in IPython 7.17 and above.
  and should_run_async(code)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=== Fit results ===
lines: [&#39;[NII]6548&#39;, &#39;H3&#39;, &#39;[NII]6584&#39;, &#39;[SII]6717&#39;, &#39;[SII]6731&#39;], fmodel: sincgauss
iterations: 56, fit time: 4.02e-01 s
Velocity (km/s): [53.74(14) 62.98(15) 53.74(14) 53.74(14) 53.74(14)]
Flux: [9.372(85)e-14 2.984(12)e-13 2.887(12)e-13 1.753(84)e-14 1.674(84)e-14]
Broadening (km/s): [15.61(54) 17.90(48) 15.61(54) 15.61(54) 15.61(54)]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_11_2.png" src="_images/script_example_fit_region_11_2.png" />
</div>
</div>
</div>
<div class="section" id="Fit-the-ROI">
<h2>Fit the ROI<a class="headerlink" href="#Fit-the-ROI" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Estimate-parameters-in-the-ROI">
<h3>Estimate parameters in the ROI<a class="headerlink" href="#Estimate-parameters-in-the-ROI" title="Permalink to this headline">¶</a></h3>
<p>We can start by estimating the parameters (especially the velocity) in the region we want to fit. The estimated velocity map can then be used as an input in the fitting process. It is a very fast process which should be always done before running a long fitting process. As an example we will run the estimation on a much larger region of the cube.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>estimates = cube.estimate_parameters_in_region(&#39;large_reg_m57.reg&#39;, (&#39;[NII]6548&#39;, &#39;Halpha&#39;, &#39;[NII]6583&#39;, &#39;[SII]6716&#39;, &#39;[SII]6731&#39;), [-300, 300],
                                               binning=10)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/thomas/miniconda3/envs/orb3/lib/python3.7/site-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_cell` automatically in the future. Please pass the result to `transformed_cell` argument and any exception that happen during thetransform in `preprocessing_exc_tuple` in IPython 7.17 and above.
  and should_run_async(code)
INFO:root:Init of the parallel processing server with 32 threads
INFO:root:passed mapped kwargs : []
INFO:root:79 rows to fit
/home/thomas/Astro/Python/ORB/Orb/orb/utils/image.py:1120: RuntimeWarning: Mean of empty slice
  return np.squeeze(np.nanmean(np.nanmean(im_view, axis=3), axis=1))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 32.7 s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:root:Closing parallel processing server
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:root:Data written as ./M57_SN3/M57_SN3.SpectralCube.estimated_velocity.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/M57_SN3.SpectralCube.estimated_[NII]6548.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/M57_SN3.SpectralCube.estimated_Halpha.fits in 0.26 s
INFO:root:Data written as ./M57_SN3/M57_SN3.SpectralCube.estimated_[NII]6583.fits in 0.26 s
INFO:root:Data written as ./M57_SN3/M57_SN3.SpectralCube.estimated_[SII]6716.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/M57_SN3.SpectralCube.estimated_[SII]6731.fits in 0.26 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import orb.utils.graph as graph
vel_map = orb.utils.io.read_fits(&#39;./M57_SN3/M57_SN3.SpectralCube.estimated_velocity.fits&#39;)
graph.imshow(vel_map)
pl.xlim(380, 1200)
pl.ylim(400, 1220)
pl.colorbar()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/thomas/miniconda3/envs/orb3/lib/python3.7/site-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_cell` automatically in the future. Please pass the result to `transformed_cell` argument and any exception that happen during thetransform in `preprocessing_exc_tuple` in IPython 7.17 and above.
  and should_run_async(code)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x7f5348165110&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_15_2.png" src="_images/script_example_fit_region_15_2.png" />
</div>
</div>
<p>We are ready to fit all the spectra in the defined ROI.</p>
<ul class="simple">
<li><p>The guess on sigma must be small – as small as the smaller sigma you expect – but not too small (&lt; 0.1 km/s). 1 km/s is a good guess. In theory we can expect a sigma of 0 km/s for unbroadened lines but the loss of modulation efficiency can broaden the line by a few km/s (see Baril et al. 2016 <a class="reference external" href="http://proceedings.spiedigitallibrary.org/proceeding.aspx?doi=10.1117/12.2232075">http://proceedings.spiedigitallibrary.org/proceeding.aspx?doi=10.1117/12.2232075</a> and Martin et al. 2016 <a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2016MNRAS.463.4223M">http://cdsads.u-strasbg.fr/abs/2016MNRAS.463.4223M</a>)</p></li>
<li><p>Don’t hesitate to fit binned data first, you will gain time and SNR which is a good way to check fitting errors.</p></li>
<li><p>warning: Jupyter can give an error (neverending fit process) if the fit below is done more than one time. Just restart the kernel as a workaround.</p></li>
</ul>
</div>
<div class="section" id="3x3-binning">
<h3>3x3 binning<a class="headerlink" href="#3x3-binning" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># warning: Jupyter can give an error (neverending fit process) if the fit below is done more than one time. Just restart the kernel as a workaround and run the
# following cells before doing the fit
from orcs.process import SpectralCube
import pylab as pl
import orb.utils.io
import numpy as np
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/thomas/miniconda3/envs/orb3/lib/python3.7/site-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_cell` automatically in the future. Please pass the result to `transformed_cell` argument and any exception that happen during thetransform in `preprocessing_exc_tuple` in IPython 7.17 and above.
  and should_run_async(code)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cube = SpectralCube(&#39;/home/thomas/local/M57_SN3.merged.cm1.1.0.hdf5&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:root:both level2 and level3 in attrs
INFO:root:Cube is level 3
INFO:root:shape: (2048, 2064, 593)
INFO:root:wavenumber calibration: True
INFO:root:flux calibration: True
INFO:root:wcs calibration: True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>new_vel = 50 # km/s
cube.fit_lines_in_region(&#39;region.reg&#39;,
        (&#39;[NII]6548&#39;, &#39;Halpha&#39;, &#39;[NII]6583&#39;, &#39;[SII]6716&#39;, &#39;[SII]6731&#39;),
                   fmodel=&#39;sincgauss&#39;,
                   pos_def=[&#39;1&#39;,&#39;2&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;],
                   pos_cov_map=vel_map,
                   sigma_def=[&#39;1&#39;,&#39;2&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;],
                   sigma_cov=[20, 20],
                   nofilter=True, binning=3)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:root:nans and infs in passed map pos_cov_map will be replaced by the median of the map
INFO:root:Number of spectra to fit: 511
INFO:root:Init of the parallel processing server with 32 threads
INFO:root:passed mapped kwargs : [&#39;pos_cov_0&#39;]
INFO:root:26 rows to fit
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [=         ] [11%] [] [remains: unknown]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/thomas/Astro/Python/ORB/Orb/orb/utils/image.py:1120: RuntimeWarning: Mean of empty slice
  return np.squeeze(np.nanmean(np.nanmean(im_view, axis=3), axis=1))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 9.0 s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:root:Closing parallel processing server
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:root:all maps saved as ./M57_SN3/MAPS/M57_SN3.LineMaps.maps.3x3.hdf5
INFO:root:Writing height maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.height.fits in 0.02 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.height.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.height.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.height.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.height.fits in 0.01 s
INFO:root:Writing height-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.height-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.height-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.height-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.height-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.height-err.fits in 0.02 s
INFO:root:Writing amplitude maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.amplitude.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.amplitude.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.amplitude.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.amplitude.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.amplitude.fits in 0.01 s
INFO:root:Writing amplitude-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.amplitude-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.amplitude-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.amplitude-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.amplitude-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.amplitude-err.fits in 0.01 s
INFO:root:Writing velocity maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.velocity.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.velocity.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.velocity.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.velocity.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.velocity.fits in 0.01 s
INFO:root:Writing velocity-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.velocity-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.velocity-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.velocity-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.velocity-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.velocity-err.fits in 0.01 s
INFO:root:Writing fwhm maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.fwhm.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.fwhm.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.fwhm.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.fwhm.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.fwhm.fits in 0.01 s
INFO:root:Writing fwhm-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.fwhm-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.fwhm-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.fwhm-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.fwhm-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.fwhm-err.fits in 0.01 s
INFO:root:Writing sigma maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.sigma.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.sigma.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.sigma.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.sigma.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.sigma.fits in 0.01 s
INFO:root:Writing sigma-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.sigma-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.sigma-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.sigma-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.sigma-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.sigma-err.fits in 0.01 s
INFO:root:Writing flux maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.flux.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.flux.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.flux.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.flux.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.flux.fits in 0.01 s
INFO:root:Writing flux-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.flux-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.flux-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.flux-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.flux-err.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.flux-err.fits in 0.01 s
INFO:root:Writing logGBF maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.logGBF.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.logGBF.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.logGBF.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.logGBF.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.logGBF.fits in 0.01 s
INFO:root:Writing chi2 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.chi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.chi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.chi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.chi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.chi2.fits in 0.01 s
INFO:root:Writing rchi2 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.rchi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.rchi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.rchi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.rchi2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.rchi2.fits in 0.01 s
INFO:root:Writing ks_pvalue maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.ks_pvalue.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.ks_pvalue.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.ks_pvalue.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.ks_pvalue.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.ks_pvalue.fits in 0.01 s
INFO:root:Writing cont_p0 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.cont_p0.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.cont_p0.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.cont_p0.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.cont_p0.fits in 0.02 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.cont_p0.fits in 0.01 s
INFO:root:Writing cont_p1 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.cont_p1.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.cont_p1.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.cont_p1.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.cont_p1.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.cont_p1.fits in 0.01 s
INFO:root:Writing cont_p2 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.cont_p2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.cont_p2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.cont_p2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.cont_p2.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.cont_p2.fits in 0.01 s
INFO:root:Writing cont_p3 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.3x3.cont_p3.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.cont_p3.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.cont_p3.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.3x3.cont_p3.fits in 0.01 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.3x3.cont_p3.fits in 0.01 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;orcs.core.LineMaps at 0x7f607832e550&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="Check-the-results">
<h3>Check the results<a class="headerlink" href="#Check-the-results" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>def show_map(path, title):
    fig = pl.figure()
    ax = fig.add_subplot(111, projection=cube.get_wcs())
    ax.coords[0].set_major_formatter(&#39;hh:mm:ss.s&#39;)
    ax.coords[1].set_major_formatter(&#39;dd:mm:ss&#39;)
    _map = orb.utils.io.read_fits(path)
    pl.imshow(_map.T, origin=&#39;lower&#39;,
              vmin=np.nanpercentile(_map, 10),
              vmax=np.nanpercentile(_map, 90))
    pl.xlim((700/3,780/3))
    pl.ylim((850/3,930/3))
    pl.colorbar()
    pl.title(title)

show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.flux.fits&#39;, r&#39;H$\alpha$ flux (erg/cm$^2$/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.velocity.fits&#39;, r&#39;H$\alpha$ velocity (km/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.sigma.fits&#39;, r&#39;H$\alpha$ broadening (km/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.flux.fits&#39;, r&#39;[NII]6583 flux (erg/cm$^2$/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.velocity.fits&#39;, r&#39;[NII]6583 velocity (km/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.3x3.sigma.fits&#39;, r&#39;[NII]6583 broadening (km/s)&#39;)

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_22_0.png" src="_images/script_example_fit_region_22_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_22_1.png" src="_images/script_example_fit_region_22_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_22_2.png" src="_images/script_example_fit_region_22_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_22_3.png" src="_images/script_example_fit_region_22_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_22_4.png" src="_images/script_example_fit_region_22_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_22_5.png" src="_images/script_example_fit_region_22_5.png" />
</div>
</div>
</div>
<div class="section" id="1x1-binning">
<h3>1x1 binning<a class="headerlink" href="#1x1-binning" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># warning: Jupyter can give an error (neverending fit process) if the fit below is done more than one time. Just restart the kernel as a workaround and run the
# following cells before doing the fit
from orcs.process import SpectralCube
import pylab as pl
import orb.utils.io
import numpy as np
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cube = SpectralCube(&#39;/home/thomas/local/M57_SN3.merged.cm1.1.0.hdf5&#39;, debug=False)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-yellow-fg">master.11e5|WARNING| both level2 and level3 in attrs</span>
master.11e5|INFO| Cube is level 3
master.11e5|INFO| shape: (2048, 2064, 593)
master.11e5|INFO| wavenumber calibration: True
master.11e5|INFO| flux calibration: True
master.11e5|INFO| wcs calibration: False
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># we can use the binned map as an input for the new fit process
vel_map = orb.utils.io.read_fits(&#39;./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.velocity.fits&#39;)
sig_map = orb.utils.io.read_fits(&#39;./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.3x3.sigma.fits&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cube.fit_lines_in_region(&#39;region.reg&#39;,
        (&#39;[NII]6548&#39;, &#39;Halpha&#39;, &#39;[NII]6583&#39;, &#39;[SII]6716&#39;, &#39;[SII]6731&#39;),
                   fmodel=&#39;sincgauss&#39;,
                   pos_def=[&#39;1&#39;,&#39;2&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;],
                   pos_cov_map=vel_map,
                   sigma_def=[&#39;1&#39;,&#39;2&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;],
                   sigma_cov_map=sig_map,
                   nofilter=True, binning=1)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:root:nans and infs in passed map pos_cov_map will be replaced by the median of the map
WARNING:root:nans and infs in passed map sigma_cov_map will be replaced by the median of the map
INFO:root:Number of spectra to fit: 4604
INFO:root:Init of the parallel processing server with 32 threads
INFO:root:passed mapped kwargs : [&#39;pos_cov_0&#39;, &#39;sigma_cov_0&#39;]
INFO:root:77 rows to fit
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 24.5 s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:root:Closing parallel processing server
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:root:all maps saved as ./M57_SN3/MAPS/M57_SN3.LineMaps.maps.1x1.hdf5
INFO:root:Writing height maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.height.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.height.fits in 0.30 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.height.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.height.fits in 0.32 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.height.fits in 0.27 s
INFO:root:Writing height-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.height-err.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.height-err.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.height-err.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.height-err.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.height-err.fits in 0.29 s
INFO:root:Writing amplitude maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.amplitude.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.amplitude.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.amplitude.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.amplitude.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.amplitude.fits in 0.04 s
INFO:root:Writing amplitude-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.amplitude-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.amplitude-err.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.amplitude-err.fits in 0.06 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.amplitude-err.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.amplitude-err.fits in 0.05 s
INFO:root:Writing velocity maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.velocity.fits in 0.06 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.velocity.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.velocity.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.velocity.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.velocity.fits in 0.05 s
INFO:root:Writing velocity-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.velocity-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.velocity-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.velocity-err.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.velocity-err.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.velocity-err.fits in 0.07 s
INFO:root:Writing fwhm maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.fwhm.fits in 0.30 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.fwhm.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.fwhm.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.fwhm.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.fwhm.fits in 0.29 s
INFO:root:Writing fwhm-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.fwhm-err.fits in 0.29 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.fwhm-err.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.fwhm-err.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.fwhm-err.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.fwhm-err.fits in 0.27 s
INFO:root:Writing sigma maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.sigma.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.sigma.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.sigma.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.sigma.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.sigma.fits in 0.05 s
INFO:root:Writing sigma-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.sigma-err.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.sigma-err.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.sigma-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.sigma-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.sigma-err.fits in 0.04 s
INFO:root:Writing flux maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.flux.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.flux.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.flux.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.flux.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.flux.fits in 0.04 s
INFO:root:Writing flux-err maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.flux-err.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.flux-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.flux-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.flux-err.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.flux-err.fits in 0.04 s
INFO:root:Writing logGBF maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.logGBF.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.logGBF.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.logGBF.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.logGBF.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.logGBF.fits in 0.05 s
INFO:root:Writing chi2 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.chi2.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.chi2.fits in 0.26 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.chi2.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.chi2.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.chi2.fits in 0.27 s
INFO:root:Writing rchi2 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.rchi2.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.rchi2.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.rchi2.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.rchi2.fits in 0.26 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.rchi2.fits in 0.29 s
INFO:root:Writing ks_pvalue maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.ks_pvalue.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.ks_pvalue.fits in 0.26 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.ks_pvalue.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.ks_pvalue.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.ks_pvalue.fits in 0.27 s
INFO:root:Writing cont_p0 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.cont_p0.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.cont_p0.fits in 0.26 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.cont_p0.fits in 0.28 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.cont_p0.fits in 0.27 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.cont_p0.fits in 0.28 s
INFO:root:Writing cont_p1 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.cont_p1.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.cont_p1.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.cont_p1.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.cont_p1.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.cont_p1.fits in 0.04 s
INFO:root:Writing cont_p2 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.cont_p2.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.cont_p2.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.cont_p2.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.cont_p2.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.cont_p2.fits in 0.04 s
INFO:root:Writing cont_p3 maps
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6548.1x1.cont_p3.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.cont_p3.fits in 0.05 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.cont_p3.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6716.1x1.cont_p3.fits in 0.04 s
INFO:root:Data written as ./M57_SN3/MAPS/M57_SN3.LineMaps.map.6731.1x1.cont_p3.fits in 0.04 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;orcs.core.LineMaps at 0x7f605900d850&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>def show_map(path, title):
    fig = pl.figure()
    ax = fig.add_subplot(111, projection=cube.get_wcs())
    ax.coords[0].set_major_formatter(&#39;hh:mm:ss.s&#39;)
    ax.coords[1].set_major_formatter(&#39;dd:mm:ss&#39;)
    _map = orb.utils.io.read_fits(path)
    pl.imshow(_map.T, origin=&#39;lower&#39;,
              vmin=np.nanpercentile(_map, 1),
              vmax=np.nanpercentile(_map, 99))
    pl.xlim((700,780))
    pl.ylim((850,930))
    pl.colorbar()
    pl.title(title)

show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.flux.fits&#39;, r&#39;H$\alpha$ flux (erg/cm$^2$/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.velocity.fits&#39;, r&#39;H$\alpha$ velocity (km/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6563.1x1.sigma.fits&#39;, r&#39;H$\alpha$ broadening (km/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.flux.fits&#39;, r&#39;[NII]6583 flux (erg/cm$^2$/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.velocity.fits&#39;, r&#39;[NII]6583 velocity (km/s)&#39;)
show_map(&#39;M57_SN3/MAPS/M57_SN3.LineMaps.map.6583.1x1.sigma.fits&#39;, r&#39;[NII]6583 broadening (km/s)&#39;)

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_28_0.png" src="_images/script_example_fit_region_28_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_28_1.png" src="_images/script_example_fit_region_28_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_28_2.png" src="_images/script_example_fit_region_28_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_28_3.png" src="_images/script_example_fit_region_28_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_28_4.png" src="_images/script_example_fit_region_28_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/script_example_fit_region_28_5.png" src="_images/script_example_fit_region_28_5.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="script_example_velocity_parameter_precision.html" class="btn btn-neutral float-left" title="How precise must be the input velocity parameter ?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Thomas Martin (thomas.martin.1@ulaval.ca).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>